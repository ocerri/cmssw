Half ported:
  InternalParticle.cpp (ln 135)
